<!DOCTYPE html>
<html>
<head>
  <title>PORT SCANNING IN NSE SCRIPT</title>
</head>
<body>
  <h1>Welcome to my documentation!</h1>
  <p>This is an sample script of portscanning in nmap script engine.</p>
  <h2>SCRIPT:</h2>
  <p>local nmap = require "nmap" <br>
    local socket = require "socket" <br>
    
    local portscan = { <br>
      name = "portscan", <br>
      author = "bhuvanes", <br>
      categories = {"discovery", "safe"}
    } <br>
    
    description = [[ <br>
        This is a sample script for port scanning using LuaSocket library's tcp.connect function. <br>
    ]] <br>
     
    -- RULE -- <br>
    portrule = function(host, port) <br>
      return port.protocol == "tcp" and port.state == "open" <br>
    end <br>
    
    -- ACTION -- <br>
    action = function(host, port) <br>
      local client = nmap.new_socket() <br>
      local result = client:connect(host, port) <br>
      if result then <br>
        print("Port "..port.number.." is open.") <br>
      else <br>
        print("Port "..port.number.." is closed.") <br>
      end <br>
      client:close() <br>
    end <br>
    
    </p>
    <h2>REQUIRMENT:</h2>
    <p>
        NMAP <br>
        KALI LINUX
    </p>
    <h2>CODE EXPLAIN:</h2>
    <p>
        This is a simple Nmap Script Engine (NSE) script written in Lua that performs a port scan using the LuaSocket library's tcp.connect function. Here is a brief overview of the script: <br>

•	The first two lines of the script load the nmap and socket libraries, which provide NSE-specific functions and LuaSocket functionality, respectively. <br>
•	The portscan table defines some metadata about the script, including its name, author, and categories.<br>
•	The description string provides a brief description of the script's functionality.<br>
•	The portrule function defines a rule for selecting which ports to scan. In this case, the rule selects all TCP ports that are in the "open" state.<br>
•	The action function is called for each open port that matches the portrule. It creates a new client socket using nmap.new_socket(), and attempts to connect to the host and port using client:connect(host, port).<br>
•	If the connection succeeds, the script prints a message to the console indicating that the port is open. Otherwise, the script prints a message indicating that the port is closed.<br>
•	Finally, the client:close() statement is called to close the client socket.<br>
Overall, this script provides a basic example of how to use LuaSocket and the NSE to perform a simple port scan. However, it may not be suitable for all environments and use cases, and should be modified and tested accordingly.<br>

    </p>
    <h2>CODE:</h2>
    <p>sudo nmap --script=portscan target:ip addr</p>
    <h2>OUTPUT:</h2>
    <img src="new.png" alt="">
    <h2>CONCLUSION:</h2>
    <p>
        port scanning in Nmap Script Engine is a powerful and flexible way to identify open ports and services on a target system. With NSE scripts written in Lua, it is possible to customize port scanning for specific environments, protocols, and use cases, making it a valuable tool for security assessment and network exploration. However, it should be used responsibly and with permission, as unauthorized port scanning can cause disruptions and legal issues. <br>
    </p>
</body>
</html>
